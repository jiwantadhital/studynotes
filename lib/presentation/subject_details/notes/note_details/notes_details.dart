import 'package:flutter/material.dart';
import 'package:flutter/src/widgets/framework.dart';
import 'package:flutter/src/widgets/placeholder.dart';
import 'package:flutter_html/flutter_html.dart';
import 'package:studynotes/resources/colors.dart';

class NotesDetails extends StatefulWidget {
  const NotesDetails({super.key});

  @override
  State<NotesDetails> createState() => _NotesDetailsState();
}

class _NotesDetailsState extends State<NotesDetails> {
  bool show = false;
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: CustomScrollView(
        physics: ClampingScrollPhysics(),
        slivers: [
          SliverAppBar(
                actions: [
                  IconButton(
                  onPressed: () {
                      show == false?  show=true:show=false;
                    setState(() {
                     
                    });
                  },
                  icon: const Icon(Icons.settings)),
                  const SizedBox(
                width: 12,
                  ),
                ],
                floating: true,
                centerTitle: true,
                elevation: 0,
                backgroundColor: ColorManager.primaryColor,
                title: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                Center(
                  child: Text(
                    "1",
                    style: const TextStyle(
                      fontSize: 18,
                      fontWeight: FontWeight.bold,
                    ),
                  ),
                ),
                Center(
                  child: Text("Chapter 1 - Introduction",
                      style: const TextStyle(
                          fontSize: 12,
                          fontWeight: FontWeight.normal,
                          fontFamily: 'Roboto')),
                ),
                  ],
                ),
              ),
              SliverToBoxAdapter(
                child: GestureDetector(
                  onTap: (){
                    show=false;
                    setState(() {
                      
                    });
                  },
                  child: Container(
                    margin: EdgeInsets.only(left: 10,right: 10),
                    child: InteractiveViewer(
                      panEnabled: false, // Set it to false to prevent panning. 
                      boundaryMargin: EdgeInsets.all(80),
                      minScale: 0.5,
                    maxScale: 4,
                      child: Center(child: Html(data: '<div class="ha hb hc hd he"><img src="" alt="Red dot" /><div class=""><h1 id="2982" class="pw-post-title hp hq hh bd hr hs ack hu hv hw acl hy hz ia acm ic id ie acn ig ih ii aco ik il im bi" data-selectable-paragraph="">All You Need to Know about Spherical Harmonics</h1></div><div class=""><h2 id="3b51" class="pw-subtitle-paragraph in hq hh bd b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je dw" data-selectable-paragraph="">And how to use and visualize them in Python</h2></div><figure class="jg jh ji jj fc jk eq er paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="eq er acp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7GzOrm1QGalJQ7WlWXPJig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*7GzOrm1QGalJQ7WlWXPJig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7GzOrm1QGalJQ7WlWXPJig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7GzOrm1QGalJQ7WlWXPJig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7GzOrm1QGalJQ7WlWXPJig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7GzOrm1QGalJQ7WlWXPJig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7GzOrm1QGalJQ7WlWXPJig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*7GzOrm1QGalJQ7WlWXPJig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bf jp jq c" width="700" height="575" loading="eager" role="presentation" src="https://miro.medium.com/max/700/1*7GzOrm1QGalJQ7WlWXPJig.png"></picture></div></div></figure><p id="2cda" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">Spherical harmonics are a powerful tool used in mathematics and physics to describe a wide range of phenomena. They can be used to model physical phenomena such as sound waves, heat transfer, and even quantum systems, and they appear whenever you are working with partial differential equations in spherical coordinates. In this article, we will explore what spherical harmonics are, their most important properties, how they work, and why theyâ€™re so useful. Finally, we will see how we can use them in Python, both numerically and symbolically. And we will create our own visualizations of these functions so that you can play with them yourselves.</p><div class="acq acr ey fa acs"><div role="button" tabindex="0" class="ab bv fe cb dx act acu bn acv jp my"><div class="acw l"><div class="ab q"><div class="l di"><img alt="Mathcube" class="l de bw wq wr dt" src="https://miro.medium.com/fit/c/20/20/1*PMw---FG7kXxOoEkfPl-Zw.jpeg" width="20" height="20" loading="lazy"><div class="dr bw l wq wr ds n"></div></div><div class="gf l dv"><p class="bd b fo z dx dy dz ea eb ec ed ee dw"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" rel="noopener follow" target="_top" href="/@mathcube7?source=post_page-----29ff76e74ad5 --------------------------------">Mathcube</a></p></div></div><div class="wm rh ff l"><h2 class="bd hr aez md dx afa dz ea acd ec ee hq bi">Daily Dose of Scientific Python</h2></div><div class="ab q"><div class="l dv"><a class="bd b be z bi afb au vm vn tt ot vo an fw fx vp vq vr ga gb gc de bk gd" rel="noopener follow" target="_top" href="/@mathcube7/list/daily-dose-of-scientific-python-bc0c16acad46?source=post_page-----29ff76e74ad5--------------------------------">View list</a></div><div class="afc l dv"><span class="bd b fo z dw">76 stories</span></div></div></div><div class="adi dh adj dx ab zx dv di"><div class="di adb bv adc add"><div class="dh l"><img alt="" class="dh" src="https://miro.medium.com/fit/c/194/194/1*jT3NRyuXz7s5jc3R0WzSGw.png" width="194" height="194" loading="lazy" role="presentation"></div></div><div class="di adb bv ade adf adg"><div class="dh l"><img alt="" class="dh" src="https://miro.medium.com/fit/c/194/194/0*LxDI8jSEK-gEiytG" width="194" height="194" loading="lazy" role="presentation"></div></div><div class="di bv no adh adg"><div class="dh l"><img alt="" class="dh" src="https://miro.medium.com/fit/c/194/194/1*EPh4nLCaL4U6hui4JMViAQ.png" width="194" height="194" loading="lazy" role="presentation"></div></div></div></div></div><h1 id="63ca" class="kt ku hh bd kv kw kx ky kz la lb lc ld iw le ix lf iz lg ja lh jc li jd lj lk bi" data-selectable-paragraph="">Spherical harmonics are eigenfunctions</h1><p id="101f" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">The spherical harmonics are defined in terms of the angular coordinates (latitude and longitude) on the sphere and have the property that they are eigenfunctions of the angular part of the Laplace operator. What does that mean?</p><p id="3648" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">In spherical coordinates, the Laplace operator when applied to a function ğ‘“ reads</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="eq er adp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3A5bzxUUbBqWwm98A2o_6Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*3A5bzxUUbBqWwm98A2o_6Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3A5bzxUUbBqWwm98A2o_6Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3A5bzxUUbBqWwm98A2o_6Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3A5bzxUUbBqWwm98A2o_6Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3A5bzxUUbBqWwm98A2o_6Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3A5bzxUUbBqWwm98A2o_6Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3A5bzxUUbBqWwm98A2o_6Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bf jp jq c" width="700" height="137" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*3A5bzxUUbBqWwm98A2o_6Q.png"></picture></div></div><figcaption class="jr js es eq er jt ju bd b be z dw" data-selectable-paragraph="">The Laplace operator in spherical coordinates</figcaption></figure><p id="fa56" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">where <em class="ks">Î¸</em> is the polar angle and <em class="ks">Ï†</em> is the azimuthal angle. So the Laplacian naturally splits into a radial and an angular part (<em class="ks">LÂ²</em>).</p><p id="ac89" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">Spherical harmonics are the eigenfunctions of the angular part of the Laplace operator. This means that when the angular part of the Laplace operator is applied to a spherical harmonic function, the result is a scalar multiple of the original function:</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="eq er adq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phOlWF-fMu5uBC6_tuUbVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*phOlWF-fMu5uBC6_tuUbVg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*phOlWF-fMu5uBC6_tuUbVg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*phOlWF-fMu5uBC6_tuUbVg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*phOlWF-fMu5uBC6_tuUbVg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*phOlWF-fMu5uBC6_tuUbVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*phOlWF-fMu5uBC6_tuUbVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*phOlWF-fMu5uBC6_tuUbVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bf jp jq c" width="700" height="73" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*phOlWF-fMu5uBC6_tuUbVg.png"></picture></div></div></figure><p id="be5b" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">where <em class="ks">LÂ²</em> is the angular part of the Laplace operator, <em class="ks">Yâ‚—â‚˜(Î¸,Ï†)</em> is the spherical harmonic of degree l and order m, and <em class="ks">-l(l+1)</em> is the eigenvalue of the function.</p><p id="af5a" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">There are different conventions about the ordering of the indices. Sometimes they are ğ‘™ğ‘š, sometimes reversed, sometimes both indices downstairs, sometimes one upstairs one downstairs. The notation used here agrees with the common notation used in physics and in particular quantum mechanics. Thatâ€™s also where the notation <em class="ks">LÂ²</em> for the angular part of the Laplacian comes from. In quantum mechanics, <em class="ks">LÂ²</em> is the square of the angular momentum operator and this gives an intuitive meaning to the indices ğ‘™ and ğ‘š. ğ‘™ (or actually ğ‘™(ğ‘™+1)) stands for the magnitude of the angular momentum of a particle and ğ‘š stands for the z-component of the angular momentum. The important thing to remember is the following: ğ‘™ can be any non-negative integer 0, 1, 2, â€¦ etc., whereas ğ‘š can only have the values âˆ’ğ‘™,âˆ’ğ‘™+1,âˆ’ğ‘™+1,â€¦,ğ‘™âˆ’2,ğ‘™âˆ’1,ğ‘™ for given ğ‘™.</p><h1 id="e648" class="kt ku hh bd kv kw kx ky kz la lb lc ld iw le ix lf iz lg ja lh jc li jd lj lk bi" data-selectable-paragraph="">Spherical harmonics are orthogonal</h1><p id="cf5c" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">The orthogonality property of spherical harmonics states that the integral of the product of two spherical harmonics over the surface of the sphere is equal to zero if the degree and order of the two harmonics are not equal. This is the same property that sines and cosines have, too. Think of Fourier transforms!</p><p id="0236" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">Formally, the orthogonality property of spherical harmonics can be expressed as:</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="eq er adr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfygF9FWZyF7L9iYLja-PQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*DfygF9FWZyF7L9iYLja-PQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DfygF9FWZyF7L9iYLja-PQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DfygF9FWZyF7L9iYLja-PQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DfygF9FWZyF7L9iYLja-PQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DfygF9FWZyF7L9iYLja-PQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DfygF9FWZyF7L9iYLja-PQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DfygF9FWZyF7L9iYLja-PQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bf jp jq c" width="700" height="107" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*DfygF9FWZyF7L9iYLja-PQ.png"></picture></div></div><figcaption class="jr js es eq er jt ju bd b be z dw" data-selectable-paragraph="">Orthogonality property</figcaption></figure><p id="9819" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">where <em class="ks">Î´â‚˜â‚™</em> is the Kronecker delta, which is 1 if <em class="ks">m=n</em> and 0 otherwise, and ğ‘‘Î©=sinğœƒğ‘‘ğœƒğ‘‘ğœ‘ is the integration measure for integrating over the surface of a sphere. Note that many of the spherical harmonics are complex, thatâ€™s why there is a conjugation star in the formula.</p><p id="b1b9" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">This property means that the spherical harmonics of different degree and order are independent of each other. This independence allows us to represent any function defined on the surface of the sphere as a sum of spherical harmonics of different degree and order, without any cross-term interference.</p><p id="a8d6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">This orthogonality property also allows to simplify the calculation of the integral of a product of two functions defined on the sphere, by decomposing each function into a series of spherical harmonics and then using the orthogonality property to calculate the integral term by term.</p><h1 id="16e9" class="kt ku hh bd kv kw kx ky kz la lb lc ld iw le ix lf iz lg ja lh jc li jd lj lk bi" data-selectable-paragraph="">Spherical harmonics are normalized</h1><p id="cc55" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">Spherical harmonics are also normalized. That means that the integral of the square of a spherical harmonic over the surface of the sphere is equal to one:</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div class="eq er ads"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 1100w, https://miro.medium.com/v2/resize:fit:1312/format:webp/1*muTQPv18BkL7IRxR5i09jA.png 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*muTQPv18BkL7IRxR5i09jA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*muTQPv18BkL7IRxR5i09jA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*muTQPv18BkL7IRxR5i09jA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*muTQPv18BkL7IRxR5i09jA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*muTQPv18BkL7IRxR5i09jA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*muTQPv18BkL7IRxR5i09jA.png 1100w, https://miro.medium.com/v2/resize:fit:1312/1*muTQPv18BkL7IRxR5i09jA.png 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px"><img alt="" class="bf jp jq c" width="656" height="128" loading="lazy" role="presentation" src="https://miro.medium.com/max/656/1*muTQPv18BkL7IRxR5i09jA.png"></picture></div><figcaption class="jr js es eq er jt ju bd b be z dw" data-selectable-paragraph="">Normalization of the spherical harmonics</figcaption></figure><p id="d1c4" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">This property ensures that the spherical harmonics are properly scaled. This also means that the sum of the squares of the coefficients of the spherical harmonics expansion of a function is equal to one. This normalization property also allows to simplify the calculation of the integral of the square of a function defined on the sphere, by decomposing the function into a series of spherical harmonics and then using the normalization property to calculate the integral term by term.</p><h1 id="ea14" class="kt ku hh bd kv kw kx ky kz la lb lc ld iw le ix lf iz lg ja lh jc li jd lj lk bi" data-selectable-paragraph="">Spherical harmonics form a basis</h1><p id="bfa9" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">The completeness property of spherical harmonics means that any function defined on the surface of the sphere can be represented as a sum of spherical harmonics of different degrees and orders. This property is also known as the â€œspherical harmonics expansionâ€. This can be expressed as:</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div class="eq er adt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 1100w, https://miro.medium.com/v2/resize:fit:1360/format:webp/1*H6npbgpW7BJVuMmsqLQeuA.png 1360w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 680px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*H6npbgpW7BJVuMmsqLQeuA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*H6npbgpW7BJVuMmsqLQeuA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*H6npbgpW7BJVuMmsqLQeuA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*H6npbgpW7BJVuMmsqLQeuA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*H6npbgpW7BJVuMmsqLQeuA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*H6npbgpW7BJVuMmsqLQeuA.png 1100w, https://miro.medium.com/v2/resize:fit:1360/1*H6npbgpW7BJVuMmsqLQeuA.png 1360w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 680px"><img alt="" class="bf jp jq c" width="680" height="128" loading="lazy" role="presentation" src="https://miro.medium.com/max/680/1*H6npbgpW7BJVuMmsqLQeuA.png"></picture></div><figcaption class="jr js es eq er jt ju bd b be z dw" data-selectable-paragraph="">Expansion of a function in terms of spherical harmonics</figcaption></figure><p id="26ee" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">Where <em class="ks">f(Î¸,Ï†)</em> is any function defined on the surface of the sphere and <em class="ks">fâ‚—â‚˜</em> are the expansion coefficients. The expansion coefficients can be calculated by integrating the product of the function and each spherical harmonics over the surface of the sphere using the orthogonality property:</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div class="eq er adu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 1100w, https://miro.medium.com/v2/resize:fit:1308/format:webp/1*83-WRXxPgIbe0IZV7z7y-w.png 1308w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 654px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*83-WRXxPgIbe0IZV7z7y-w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*83-WRXxPgIbe0IZV7z7y-w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*83-WRXxPgIbe0IZV7z7y-w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*83-WRXxPgIbe0IZV7z7y-w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*83-WRXxPgIbe0IZV7z7y-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*83-WRXxPgIbe0IZV7z7y-w.png 1100w, https://miro.medium.com/v2/resize:fit:1308/1*83-WRXxPgIbe0IZV7z7y-w.png 1308w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 654px"><img alt="" class="bf jp jq c" width="654" height="118" loading="lazy" role="presentation" src="https://miro.medium.com/max/654/1*83-WRXxPgIbe0IZV7z7y-w.png"></picture></div></figure><p id="9c9b" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">This is absolutely analogous to how you would compute a Fourier transform. But in this case, you donâ€™t expand in terms of sines and cosines but in terms of spherical harmonics.</p><p id="8bc8" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">The completeness property allows to represent any function defined on the surface of the sphere in terms of a sum of simpler, computationally manageable functions. Itâ€™s important to note that the completeness of the set holds under certain conditions, such as the function being square integrable.</p><h1 id="f686" class="kt ku hh bd kv kw kx ky kz la lb lc ld iw le ix lf iz lg ja lh jc li jd lj lk bi" data-selectable-paragraph="">Spherical harmonics are symmetric</h1><p id="4bf0" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">The parity property of spherical harmonics states that the harmonics with even degree have even parity and the harmonics with an odd degree have odd parity. Formally, the parity property of spherical harmonics can be expressed as:</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="eq er adv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1TRyFrTWiQderiErfFzJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*O1TRyFrTWiQderiErfFzJw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*O1TRyFrTWiQderiErfFzJw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*O1TRyFrTWiQderiErfFzJw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*O1TRyFrTWiQderiErfFzJw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*O1TRyFrTWiQderiErfFzJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*O1TRyFrTWiQderiErfFzJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*O1TRyFrTWiQderiErfFzJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bf jp jq c" width="700" height="78" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*O1TRyFrTWiQderiErfFzJw.png"></picture></div></div></figure><p id="6074" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">and also</p><figure class="jg jh ji jj fc jk eq er paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="eq er adw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5UnBM_XfqyUtoIrGZla3RA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*5UnBM_XfqyUtoIrGZla3RA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5UnBM_XfqyUtoIrGZla3RA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5UnBM_XfqyUtoIrGZla3RA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5UnBM_XfqyUtoIrGZla3RA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5UnBM_XfqyUtoIrGZla3RA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5UnBM_XfqyUtoIrGZla3RA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5UnBM_XfqyUtoIrGZla3RA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bf jp jq c" width="700" height="65" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*5UnBM_XfqyUtoIrGZla3RA.png"></picture></div></div></figure><p id="10fa" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">This means that the spherical harmonics of even degree are unchanged when the polar angle is reflected about the equator (i.e. when <em class="ks">Î¸</em> is replaced by <em class="ks">Ï€-Î¸</em>), whereas the spherical harmonics of odd degree change sign.</p><h1 id="9581" class="kt ku hh bd kv kw kx ky kz la lb lc ld iw le ix lf iz lg ja lh jc li jd lj lk bi" data-selectable-paragraph="">How to use spherical harmonics in Python</h1><p id="ed4b" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">When you are using spherical harmonics in any software library, you have to watch out carefully, for how they are defined. Which index has the meaning of ğ‘™, and which corresponds to ğ‘š? What is the order of the angles, is it (ğœƒ,ğœ‘) or (ğœ‘,ğœƒ)? In the world of scientific Python, there are mainly two packages which are commonly used for spherical harmonics. The one is SymPy, which is a computer algebra package that allows for symbolic computation. The other package is SciPy, which is for numerical computation.</p><h2 id="ec75" class="lq ku hh bd kv lr ls lt kz lu lv lw ld kf lx ly lf kj lz ma lh kn mb mc lj hn bi" data-selectable-paragraph="">SymPy</h2><p id="aee2" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">Letâ€™s start with SymPy. In a Jupyter notebook, first import the symbols that we need:</p><pre class="jg jh ji jj fc adx ady adz bn aea aeb bi"><span id="5275" class="aec ku hh ady b be aed aee l aef aeg" data-selectable-paragraph=""><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><br>Î¸, Ï† = symbols(<span class="hljs-string">r"\theta, \phi"</span>)<br>l, m = symbols(<span class="hljs-string">"l, m"</span>, integer=<span class="hljs-literal">True</span>)</span></pre><p id="99a7" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">The spherical harmonics can be accessed by the function <code class="dt aeh aei aej ady b">Ynm</code>. In the list of arguments, ğ‘™ comes first and ğ‘š second. The order of the angles is (ğœƒ,ğœ‘):</p><pre class="jg jh ji jj fc adx ady adz bn aea aeb bi"><span id="b729" class="aec ku hh ady b be aed aee l aef aeg" data-selectable-paragraph=""><span class="hljs-attr">Y</span> = Ynm(l, m, Î¸, Ï†)</span></pre><figure class="jg jh ji jj fc jk eq er paragraph-image"><div class="eq er aek"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 1100w, https://miro.medium.com/v2/resize:fit:1012/format:webp/1*99aR7TbRntKhKccCvDq4Iw.png 1012w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 506px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*99aR7TbRntKhKccCvDq4Iw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*99aR7TbRntKhKccCvDq4Iw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*99aR7TbRntKhKccCvDq4Iw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*99aR7TbRntKhKccCvDq4Iw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*99aR7TbRntKhKccCvDq4Iw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*99aR7TbRntKhKccCvDq4Iw.png 1100w, https://miro.medium.com/v2/resize:fit:1012/1*99aR7TbRntKhKccCvDq4Iw.png 1012w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 506px"><img alt="" class="bf jp jq c" width="506" height="56" loading="lazy" role="presentation" src="https://miro.medium.com/max/506/1*99aR7TbRntKhKccCvDq4Iw.png"></picture></div></figure><p id="f2e4" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">The spherical harmonics can be expressed in terms of trigonometric functions. We can easily list them using SymPy, in this case, up to ğ‘™=3:</p><pre class="jg jh ji jj fc adx ady adz bn aea aeb bi"><span id="2cf1" class="aec ku hh ady b be aed aee l aef aeg" data-selectable-paragraph=""><span class="hljs-keyword">for</span> l_ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> m_ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, l_+<span class="hljs-number">1</span>):<br>        Y = Ynm(l_, m_, Î¸, Ï†)<br>        display(<br>            Eq(<br>                Y, Y.rewrite(cos)<br>            )<br>        )</span></pre><figure class="jg jh ji jj fc jk eq er paragraph-image"><div class="eq er ael"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1136/format:webp/1*3DIq_AxidBhHyr0j1AquBQ.png 1136w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 568px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*3DIq_AxidBhHyr0j1AquBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3DIq_AxidBhHyr0j1AquBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3DIq_AxidBhHyr0j1AquBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3DIq_AxidBhHyr0j1AquBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3DIq_AxidBhHyr0j1AquBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3DIq_AxidBhHyr0j1AquBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1136/1*3DIq_AxidBhHyr0j1AquBQ.png 1136w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 568px"><img alt="" class="bf jp jq c" width="568" height="740" loading="lazy" role="presentation" src="https://miro.medium.com/max/568/1*3DIq_AxidBhHyr0j1AquBQ.png"></picture></div></figure><p id="7a40" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">Note that we didnâ€™t list the spherical harmonics for negative ğ‘š because they are closely related to the corresponding function with positive ğ‘š (see the section on â€œparityâ€).</p><h2 id="b203" class="lq ku hh bd kv lr ls lt kz lu lv lw ld kf lx ly lf kj lz ma lh kn mb mc lj hn bi" data-selectable-paragraph="">SciPy</h2><p id="adc1" class="pw-post-body-paragraph jw jx hh jy b jz ll ir kb kc lm iu ke kf ln kh ki kj lo kl km kn lp kp kq kr ha bi" data-selectable-paragraph="">When it comes to numeric computation in Python, SciPy is an excellent choice. The spherical harmonics are part of the <code class="dt aeh aei aej ady b">special</code> subpackage for special functions. Be careful, because, in SciPy, the arguments are given in a different order than in SymPy. ğ‘š comes first and <em class="ks">l</em> second, and also the angle are given in reversed order. When you only want to compute the function for a single point, you pass single numbers for ğœ‘ and ğœƒ:</p><pre class="jg jh ji jj fc adx ady adz bn aea aeb bi"><span id="79fe" class="aec ku hh ady b be aed aee l aef aeg" data-selectable-paragraph=""><span class="hljs-keyword">from</span> scipy.special <span class="hljs-keyword">import</span> sph_harm<br><br>l_ = <span class="hljs-number">1</span><br>m_ = <span class="hljs-number">1</span><br><br>theta = np.pi/<span class="hljs-number">2</span><br>phi = <span class="hljs-number">0</span><br><br><span class="hljs-comment"># Watch out for order of arguments, its different than in SymPy!</span><br>sph_harm(m_, l_, phi, theta)</span></pre><p id="4200" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi data-selectable-paragraph="">But usually, in numeric computation, you want to give arrays of angular values, which can easily be done in NumPy:</p><pre class="jg jh ji jj fc adx ady adz bn aea aeb bi"><span id="0fdb" class="aec ku hh ady b be aed aee l aef aeg" data-selectable-paragraph=""><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># Define the 1-dimensional coordinate axes:</span><br>theta = np.linspace(<span class="hljs-number">0</span>, np.pi, <span class="hljs-number">100</span>)<br>phi = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*np.pi, <span class="hljs-number">100</span>)<br><br><span class="hljs-comment"># Make a 2D-meshed grid out of the axes:</span><br>Theta, Phi = np.meshgrid(theta, phi, indexing=<span class="hljs-string">"ij"</span>)<br><br><br>sph_harm(m_, l_, Phi, Theta)</span></pre><p id="6774" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi" data-selectable-paragraph="">Here is a little function that creates a plot of any desired spherical harmonic using the Python package plotly:</p><pre class="jg jh ji jj fc adx ady adz bn aea aeb bi"><span id="ef96" class="aec ku hh ady b be aed aee l aef aeg" data-selectable-paragraph=""><span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title.function">create_figure</span>(<span class="hljs-params">l, m</span>):<br>    <span class="hljs-string">"""Create a figure of Y_lm using Plotly."""</span><br><br>    thetas = np.linspace(<span class="hljs-number">0</span>, np.pi, <span class="hljs-number">100</span>)<br>    phis = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*np.pi, <span class="hljs-number">100</span>)<br>    <br>    Thetas, Phis = np.meshgrid(thetas, phis)<br>    <br>    ylm = sph_harm(m, l, Phi, Theta)<br><br>    fcolors = ylm.real<br>    fmax, fmin = fcolors.<span class="hljs-built_in">max</span>(), fcolors.<span class="hljs-built_in">min</span>()<br>    fcolors = (fcolors - fmin)/(fmax - fmin)<br><br>    R = <span class="hljs-built_in">abs</span>(ylm)<br>    X = R * np.sin(Theta) * np.cos(Phi)<br>    Y = R * np.sin(Theta) * np.sin(Phi)<br>    Z = R * np.cos(Theta)<br><br>    <br>    fig = go.Figure(<br>                data=[<br>                    go.Surface(<br>                        x=X, y=Y, z=Z, <br>                        surfacecolor=fcolors,<br>                     '))),
                  ),
                ),
              ),
        ],
      ),
      bottomSheet:show==true? Container(
        height: 100,
        width: MediaQuery.of(context).size.width,
        decoration: BoxDecoration(
          color: ColorManager.primaryColor
        ),
      ):Container(
        height: 5,
      ),
    );
  }
}